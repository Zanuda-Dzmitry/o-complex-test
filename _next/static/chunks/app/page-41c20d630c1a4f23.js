(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{2262:(e,t,s)=>{Promise.resolve().then(s.bind(s,9674)),Promise.resolve().then(s.bind(s,3295)),Promise.resolve().then(s.bind(s,4295)),Promise.resolve().then(s.bind(s,3271))},3271:(e,t,s)=>{"use strict";s.d(t,{Reviews:()=>l});var r=s(5155),a=s(9613),i=s(822);function l(){let{data:e,isLoading:t,isError:s}=(0,a.N7)();return t?(0,r.jsx)("div",{className:"text-center py-8",children:"Loading reviews..."}):s?(0,r.jsx)("div",{className:"text-red-500 text-center py-8",children:"Error loading reviews"}):(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:null==e?void 0:e.map(e=>(0,r.jsx)("div",{className:"p-4 rounded-lg bg-[#D9D9D9] shadow-sm",dangerouslySetInnerHTML:{__html:i.A.sanitize(e.text)}},e.id))})}},3295:(e,t,s)=>{"use strict";s.d(t,{OrderForm:()=>u});var r=s(5155),a=s(2115),i=s(9613),l=s(4540);let n=()=>(0,l.wA)(),d=l.d4;var c=s(4089);function o(){return(0,r.jsx)("div",{className:"space-y-8 p-5 rounded-lg bg-[#D9D9D9] ",children:(0,r.jsx)("div",{className:"text-green-500",children:"Заказ успешно оформлен!"})})}function u(){let[e,{isLoading:t,isSuccess:s,error:l}]=(0,i.be)(),{items:u,phone:m}=d(e=>e.cart),p=n(),[g,h]=(0,a.useState)(null),x=async t=>{t.preventDefault(),h(null);let s=m.replace(/\D/g,"");if(11!==s.length)return void h("Введите полный номер телефона");if(0===u.length)return void h("Добавьте товары в корзину");try{let t=await e({phone:s,cart:u.map(e=>({id:e.id,quantity:e.quantity}))}).unwrap();1===t.success?p((0,c.sX)()):h(t.error||"Ошибка при оформлении заказа")}catch(e){h("Ошибка при отправке заказа")}};return(0,r.jsxs)("form",{onSubmit:x,className:"space-y-4 ",children:[(0,r.jsxs)("div",{className:"flex gap-x-2",children:[(0,r.jsx)("input",{id:"phone",type:"tel",value:m,onChange:e=>{let t=e.target.value.replace(/\D/g,""),s="+7 ";t.length>1&&(s+="(".concat(t.substring(1,4))),t.length>4&&(s+=") ".concat(t.substring(4,7))),t.length>7&&(s+="-".concat(t.substring(7,9))),t.length>9&&(s+="-".concat(t.substring(9,11))),p((0,c.A5)(s))},placeholder:"+7 (___) ___-__-__",className:"w-full p-2 text-white bg-[#222222] rounded"}),(0,r.jsx)("button",{type:"submit",disabled:t,className:"px-4 py-2 rounded ".concat(t?"bg-gray-400":"bg-[#222222] hover:bg-[#222555]"," text-white"),children:t?"Отправка...":"Заказать"})]}),(g||l)&&(0,r.jsx)("div",{className:"text-red-500",children:g||"Ошибка при отправке заказа"}),s&&(0,r.jsx)(o,{})]})}},4089:(e,t,s)=>{"use strict";s.d(t,{A5:()=>c,Ay:()=>p,Fs:()=>u,JJ:()=>m,RO:()=>d,bE:()=>l,dt:()=>n,sX:()=>o});var r=s(5710);let a=(()=>{{let e=localStorage.getItem("cart"),t=localStorage.getItem("phone");return{items:e?JSON.parse(e):[],phone:t||""}}})(),i=(0,r.Z0)({name:"cart",initialState:a,reducers:{addToCart:(e,t)=>{let{id:s,quantity:r=1,price:a,title:i,image_url:l,description:n}=t.payload,d=e.items.find(e=>e.id===s);d?d.quantity+=r:e.items.push({id:s,quantity:r,price:a,title:i,image_url:l,description:n}),localStorage.setItem("cart",JSON.stringify(e.items))},removeFromCart:(e,t)=>{e.items=e.items.filter(e=>e.id!==t.payload),localStorage.setItem("cart",JSON.stringify(e.items))},updateQuantity:(e,t)=>{let s=e.items.find(e=>e.id===t.payload.id);s&&(s.quantity=t.payload.quantity,localStorage.setItem("cart",JSON.stringify(e.items)))},updatePhone:(e,t)=>{e.phone=t.payload,localStorage.setItem("phone",e.phone)},clearCart:e=>{e.items=[],e.phone="",localStorage.removeItem("cart"),localStorage.removeItem("phone")}}}),{addToCart:l,removeFromCart:n,updateQuantity:d,updatePhone:c,clearCart:o}=i.actions,u=e=>e.cart.items,m=e=>t=>{var s;return(null==(s=t.cart.items.find(t=>t.id===e))?void 0:s.quantity)||0},p=i.reducer},4295:(e,t,s)=>{"use strict";s.d(t,{Products:()=>n});var r=s(5155),a=s(2115),i=s(9613),l=s(6961);function n(){let[e,t]=(0,a.useState)([]),[s,n]=(0,a.useState)(1),{data:d,isLoading:c,isFetching:o,error:u}=(0,i.Kc)({page:s}),[m]=(0,i.IU)(),p=async()=>{let e=s+1;await m({page:e}),n(e)};(0,a.useEffect)(()=>{d&&t(e=>[...e,...d.items])},[d]),(0,a.useEffect)(()=>(window.addEventListener("scroll",g),()=>window.removeEventListener("scroll",g)),[o,d]);let g=()=>{d&&void 0!==d.total&&void 0!==d.page&&void 0!==d.amount&&window.innerHeight+window.scrollY>=document.body.offsetHeight-100&&!o&&d.total>d.page*d.amount&&p()};return c?(0,r.jsx)("div",{className:"flex justify-center py-8",children:"Загрузка..."}):u?(0,r.jsx)("div",{className:"text-red-500 p-4 text-center",children:"Ошибка загрузки"}):(0,r.jsx)("div",{className:"space-y-6",children:(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:e.map(e=>(0,r.jsxs)("div",{className:"p-5 bg-[#D9D9D9] rounded-lg overflow-hidden shadow-sm",children:[e.image_url&&(0,r.jsx)("img",{src:e.image_url,alt:e.title,className:"w-full h-48 object-cover rounded-lg mb-3"}),(0,r.jsxs)("div",{className:"p-4 justify-items-center ",children:[(0,r.jsx)("h3",{className:"font-medium text-lg mb-2",children:e.title}),(0,r.jsx)("p",{className:"text-gray-600 mb-3 line-clamp-2",children:e.description}),(0,r.jsxs)("p",{className:"font-bold text-2xl text-black mb-4",children:[e.price," ₽"]}),(0,r.jsx)(l.s,{product:e})]})]},e.id))})})}},6961:(e,t,s)=>{"use strict";s.d(t,{s:()=>l});var r=s(5155),a=s(4540),i=s(4089);function l(e){let{product:t,variant:s="default"}=e,l=(0,a.wA)(),n=(0,a.d4)((0,i.JJ)(t.id)),d=e=>{let s=n+e;s<1?l((0,i.dt)(t.id)):0===n?l((0,i.bE)({id:t.id,quantity:1,price:t.price,title:t.title,image_url:t.image_url,description:t.description})):l((0,i.RO)({id:t.id,quantity:s}))};return 0===n&&"compact"===s?null:0===n?(0,r.jsx)("button",{onClick:()=>d(1),className:"w-full text-2xl bg-[#222222] hover:bg-[#8f8c8c] text-white py-2 px-8  rounded-lg transition-colors",children:"В корзину"}):(0,r.jsxs)("div",{className:"flex gap-2 items-center ".concat("default"===s?"justify-between":"justify-end gap-2"),children:[(0,r.jsxs)("div",{className:"flex items-center border rounded-md",children:[(0,r.jsx)("button",{onClick:()=>d(-1),className:"px-3 py-1 text-lg","aria-label":"Уменьшить количество",children:"-"}),(0,r.jsx)("input",{type:"number",min:1,value:n,onChange:e=>{let s=parseInt(e.target.value,10);isNaN(s)||s<1||l((0,i.RO)({id:t.id,quantity:s}))},className:"w-10 text-center p-1"}),(0,r.jsx)("button",{onClick:()=>d(1),className:"px-3 py-1 text-lg hover:bg-gray-100","aria-label":"Увеличить количество",children:"+"})]}),"default"===s&&(0,r.jsx)("button",{onClick:()=>l((0,i.dt)(t.id)),className:"text-red-500 hover:text-red-700 text-sm","aria-label":"Удалить из корзины",children:"Удалить"})]})}},9613:(e,t,s)=>{"use strict";s.d(t,{IU:()=>d,Kc:()=>n,N7:()=>l,be:()=>c,lh:()=>i});var r=s(404),a=s(4317);let i=(0,r.xP)({reducerPath:"api",baseQuery:(0,a.cw)({baseUrl:"http://o-complex.com:1337",prepareHeaders:e=>(e.set("Content-Type","application/json"),e)}),tagTypes:["Products","Reviews","Order"],endpoints:e=>({getReviews:e.query({query:()=>"/reviews",providesTags:["Reviews"]}),getProducts:e.query({query:e=>{let{page:t,pageSize:s=20}=e;return{url:"/products",params:{page:t,page_size:s}}},providesTags:["Products"]}),submitOrder:e.mutation({query:e=>({url:"/order",method:"POST",body:e}),invalidatesTags:["Order"]})})}),{useGetReviewsQuery:l,useGetProductsQuery:n,useLazyGetProductsQuery:d,useSubmitOrderMutation:c}=i},9674:(e,t,s)=>{"use strict";s.d(t,{Cart:()=>n});var r=s(5155),a=s(4540),i=s(4089),l=s(6961);function n(){let e=(0,a.wA)(),t=(0,a.d4)(i.Fs);return(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("h2",{className:"text-xl font-bold",children:"Добавленные товары"}),0===t.length?(0,r.jsx)("p",{children:"Корзина пуста"}):(0,r.jsx)("ul",{className:"space-y-2",children:t.map(e=>(0,r.jsxs)("li",{className:"",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{children:e.title}),(0,r.jsxs)("p",{children:[e.price," ₽ \xd7 ",e.quantity]})]}),(0,r.jsx)("div",{className:"flex items-center gap-2",children:(0,r.jsx)(l.s,{product:e})})]},e.id))}),(0,r.jsx)("button",{onClick:()=>e((0,i.sX)()),className:"bg-red-500 text-white px-4 py-2 rounded",children:"Очистить корзину"})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[404,822,441,684,358],()=>t(2262)),_N_E=e.O()}]);